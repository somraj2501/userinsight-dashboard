import{a as W}from"./chunk-IOJUAVAC.js";import{A as y,Ea as F,Fa as L,Ga as f,Ha as w,Ia as b,Ka as k,La as D,Ma as h,Na as o,Oa as i,P as _,Pa as j,Q as u,Qa as S,Ra as C,Sa as x,Ta as g,Ua as O,Wa as A,Xa as s,Ya as E,Za as M,_a as N,ab as p,bb as m,cb as Q,d as z,e as v,ja as l,l as $,m as U,mb as Y,nb as R,ob as H,qa as I,ua as V,ya as P,za as B}from"./chunk-S4TDVBMF.js";import"./chunk-2NFLSA4Y.js";var G=()=>[import("./chunk-2Y2EZRJF.js").then(t=>t.UserFormComponent)],J=(t,n)=>n.email,K=(t,n)=>n.id;function X(t,n){if(t&1&&(o(0,"tr")(1,"td"),s(2),i(),o(3,"td"),s(4),i(),o(5,"td")(6,"span",24),s(7),i()()()),t&2){let e=n.$implicit;l(2),E(e.name),l(2),E(e.email),l(2),A(e.role.toLowerCase()),l(),M(" ",e.role," ")}}function Z(t,n){if(t&1){let e=C();o(0,"div",18)(1,"table")(2,"thead")(3,"tr")(4,"th"),s(5,"Name"),i(),o(6,"th"),s(7,"Email"),i(),o(8,"th"),s(9,"Role"),i()()(),o(10,"tbody"),k(11,X,8,5,"tr",null,J),p(13,"async"),i()()(),o(14,"div",19)(15,"div",20),s(16),p(17,"async"),p(18,"async"),i(),o(19,"div",21)(20,"button",22),p(21,"async"),x("click",function(){_(e);let r=g(2);return u(r.prevPage())}),s(22," Previous "),i(),o(23,"button",23),p(24,"async"),p(25,"async"),x("click",function(){_(e);let r=g(2);return u(r.nextPage())}),s(26," Next "),i()()()}if(t&2){let e=g(2);l(11),D(m(13,4,e.paginatedUsers$)),l(5),N(" Page ",m(17,6,e.currentPage$)," of ",m(18,8,e.totalPages$)," "),l(4),h("disabled",m(21,10,e.currentPage$)===1),l(3),h("disabled",m(24,12,e.currentPage$)===m(25,14,e.totalPages$))}}function ee(t,n){if(t&1){let e=C();o(0,"div",17)(1,"p"),s(2),p(3,"async"),i(),o(4,"button",25),x("click",function(){_(e);let r=g(2);return u(r.searchQuery$.next(""))}),s(5,"Clear search"),i()()}if(t&2){let e=g(2);l(2),M('No users match your search "',m(3,1,e.searchQuery$),'"')}}function te(t,n){if(t&1&&(f(0,Z,27,16),p(1,"async"),w(2,ee,6,3,"div",17)),t&2){let e,a=g();b((e=m(1,1,a.paginatedUsers$))!=null&&e.length?0:2)}}function ne(t,n){t&1&&S(0)}function ie(t,n){if(t&1&&P(0,ne,1,0,"ng-container",26),t&2){g();let e=O(35);h("ngTemplateOutlet",e)}}function oe(t,n){t&1&&(o(0,"div",14),j(1,"canvas",27),i())}function re(t,n){t&1&&S(0)}function ae(t,n){if(t&1&&P(0,re,1,0,"ng-container",26),t&2){g();let e=O(35);h("ngTemplateOutlet",e)}}function se(t,n){if(t&1){let e=C();o(0,"app-user-form",30),x("close",function(){_(e);let r=g(2);return u(r.toggleUserForm())}),i()}}function le(t,n){t&1&&(o(0,"div",31),s(1,"Loading form..."),i())}function ce(t,n){if(t&1){let e=C();o(0,"div",28,1),x("click",function(r){_(e);let c=O(1),d=g();return u(r.target===c&&d.toggleUserForm())}),o(2,"div",29),B(3,se,1,0)(4,le,2,0),F(5,3,G,4),i()()}if(t&2){let e=g();l(5),L(e.showUserForm)}}function de(t,n){t&1&&(o(0,"div",17)(1,"p"),s(2,"No users found."),i()())}function pe(t,n){if(t&1&&(o(0,"div",32),s(1),i()),t&2){let e=n.$implicit;l(),M(" ",e.message," ")}}function me(t,n){if(t&1&&(o(0,"div",16),k(1,pe,2,1,"div",32,K),p(3,"async"),i()),t&2){let e=g();l(),D(m(3,0,e.toasts$))}}var q=class t{constructor(n){this.userService=n;this.users$=this.userService.users$,this.toasts$=this.userService.toasts$;let e=U([this.users$,this.searchQuery$]).pipe($(([a,r])=>{let c=r.toLowerCase().trim();return c?a.filter(d=>d.name.toLowerCase().includes(c)||d.email.toLowerCase().includes(c)||d.role.toLowerCase().includes(c)):a}));this.searchQuery$.pipe(y(this.destroy$)).subscribe(()=>{this.currentPage$.next(1)}),e.pipe(y(this.destroy$)).subscribe(a=>{let r=Math.ceil(a.length/this.pageSize$.value);this.totalPages$.next(r||1),this.currentPage$.value>r&&r>0&&this.currentPage$.next(r)}),this.paginatedUsers$=U([e,this.currentPage$,this.pageSize$]).pipe($(([a,r,c])=>{let d=(r-1)*c;return a.slice(d,d+c)}))}users$;toasts$;paginatedUsers$;currentPage$=new v(1);pageSize$=new v(5);totalPages$=new v(1);searchQuery$=new v("");showUserForm=!1;chartInstance;destroy$=new z;ngOnInit(){this.users$.pipe(y(this.destroy$)).subscribe(n=>{n?.length&&this.initializeChart(n)})}onSearch(n){let e=n.target.value;this.searchQuery$.next(e)}async initializeChart(n){let{Chart:e,registerables:a}=await import("./chunk-KY7TXFBO.js");e.register(...a);let r=n.reduce((d,T)=>(d[T.role]=(d[T.role]||0)+1,d),{}),c=document.getElementById("roleChart");c&&(this.chartInstance&&this.chartInstance.destroy(),this.chartInstance=new e(c,{type:"pie",data:{labels:Object.keys(r),datasets:[{data:Object.values(r),backgroundColor:["#1c4980","#383838","#e3eafc"],borderWidth:0,hoverOffset:8}]},options:{responsive:!0,plugins:{legend:{position:"top",fullSize:!0},title:{display:!0,text:"User Distribution by Role"}}}}))}toggleUserForm(){this.showUserForm=!this.showUserForm}nextPage(){this.currentPage$.value<this.totalPages$.value&&this.currentPage$.next(this.currentPage$.value+1)}prevPage(){this.currentPage$.value>1&&this.currentPage$.next(this.currentPage$.value-1)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.chartInstance&&this.chartInstance.destroy()}static \u0275fac=function(e){return new(e||t)(I(W))};static \u0275cmp=V({type:t,selectors:[["app-user-dashboard"]],decls:38,vars:13,consts:[["noData",""],["overlay",""],[1,"container"],[1,"card"],[1,"card-header"],[1,"title"],[1,"subtitle"],[1,"content-grid"],[1,"card","table-card"],[1,"header-actions"],[1,"search-box"],["type","text","placeholder","Search by name, email or role",3,"input","value"],[1,"btn-add-user",3,"click"],[1,"card","chart-card"],[1,"chart-container"],[1,"modal-overlay"],[1,"toast-container"],[1,"no-results"],[1,"table-wrapper"],[1,"pagination"],[1,"pagination-info"],[1,"pagination-controls"],["aria-label","Previous page",1,"btn-page",3,"click","disabled"],["aria-label","Next page",1,"btn-page",3,"click","disabled"],[1,"role-badge"],[1,"btn-clear",3,"click"],[4,"ngTemplateOutlet"],["id","roleChart"],[1,"modal-overlay",3,"click"],[1,"modal-content"],[3,"close"],[1,"loading"],[1,"toast"]],template:function(e,a){if(e&1){let r=C();o(0,"div",2)(1,"header")(2,"div",3)(3,"div",4)(4,"span")(5,"h1",5),s(6,"User Insights"),i(),o(7,"p",6),s(8,"Manage users and their roles"),i()()()()(),o(9,"main")(10,"div",7)(11,"section",8)(12,"div",4)(13,"h2"),s(14,"User List"),i(),o(15,"div",9)(16,"div",10)(17,"input",11),p(18,"async"),x("input",function(d){return _(r),u(a.onSearch(d))}),i()(),o(19,"button",12),x("click",function(){return _(r),u(a.toggleUserForm())}),o(20,"span"),s(21,"+"),i(),s(22,"\xA0Add User "),i()()(),f(23,te,3,3),p(24,"async"),w(25,ie,1,1,"ng-container"),i(),o(26,"section",13)(27,"div",4)(28,"h2"),s(29,"Role Analytics"),i()(),f(30,oe,2,0,"div",14),p(31,"async"),w(32,ae,1,1,"ng-container"),i()()()(),f(33,ce,7,1,"div",15),P(34,de,3,0,"ng-template",null,0,Q),f(36,me,4,2,"div",16),p(37,"async")}if(e&2){let r,c,d;l(17),h("value",m(18,5,a.searchQuery$)),l(6),b((r=m(24,7,a.users$))!=null&&r.length?23:25),l(7),b((c=m(31,9,a.users$))!=null&&c.length?30:32),l(3),b(a.showUserForm?33:-1),l(3),b((d=m(37,11,a.toasts$))!=null&&d.length?36:-1)}},dependencies:[H,Y,R],styles:[".container[_ngcontent-%COMP%]{min-height:100vh;width:100%;background-color:#f4f7fa;color:var(--color-dark);padding:32px}header[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto}.title[_ngcontent-%COMP%]{font-size:24px;font-weight:800;color:var(--color-primary);margin-bottom:4px}.subtitle[_ngcontent-%COMP%]{color:#64748b;font-size:14px}main[_ngcontent-%COMP%]{max-width:1200px;margin:32px auto}.content-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 380px;gap:32px;align-items:start}@media(max-width:1024px){.content-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;border:1px solid #e1e9f1;box-shadow:0 4px 6px -1px #0000000d,0 2px 4px -1px #00000008;overflow:hidden}.card-header[_ngcontent-%COMP%]{padding:24px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #f1f5f9}.header-actions[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:center}.search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:10px 16px;border:1px solid #e2e8f0;border-radius:8px;font-size:14px;width:240px;transition:all .2s;outline:none}.search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#1c4980;box-shadow:0 0 0 3px #1c49801a}.card-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;font-weight:700}.table-wrapper[_ngcontent-%COMP%]{overflow-x:auto}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f8fafc;color:#64748b;text-transform:uppercase;font-size:14px;font-weight:700;padding:16px 24px;text-align:left;border-bottom:1px solid #f1f5f9}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:18px 24px;border-bottom:1px solid #f1f5f9;font-size:14px}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f8fafc}.role-badge[_ngcontent-%COMP%]{padding:4px 12px;border-radius:9999px;font-size:12px;font-weight:600;text-transform:capitalize}.role-badge.admin[_ngcontent-%COMP%]{color:#e1eff8;background-color:#1c4980}.role-badge.editor[_ngcontent-%COMP%]{color:#d4d4d4;background-color:#383838}.role-badge.viewer[_ngcontent-%COMP%]{color:#1c4980;background-color:#e3eafc}.chart-container[_ngcontent-%COMP%]{padding:24px;height:350px;display:flex;align-items:center;justify-content:center}.btn-add-user[_ngcontent-%COMP%]{padding:0 24px;font-size:14px;text-align:center}.btn-add-user[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:18px}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.modal-content[_ngcontent-%COMP%]{background:#fff;padding:0;border-radius:16px;box-shadow:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a;width:100%;max-width:500px;animation:_ngcontent-%COMP%_modalAppear .3s ease-out}@keyframes _ngcontent-%COMP%_modalAppear{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.loading[_ngcontent-%COMP%]{padding:40px;text-align:center;color:var(--color-primary)}.no-results[_ngcontent-%COMP%]{padding:48px 24px;text-align:center;color:#64748b;display:flex;flex-direction:column;align-items:center;gap:16px}.no-results[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;font-weight:500}.btn-clear[_ngcontent-%COMP%]{color:#1c4980;background:none;border:none;font-weight:600;font-size:14px;cursor:pointer;text-decoration:underline}.btn-clear[_ngcontent-%COMP%]:hover{color:#2563eb}.pagination[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem 1.5rem;border-top:1px solid #f1f5f9;background-color:#f8fafc}.pagination-info[_ngcontent-%COMP%]{font-size:14px;color:#64748b;font-weight:500}.pagination-controls[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-page[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:var(--color-primary);background-color:#fff;border:1px solid #e2e8f0;border-radius:8px;cursor:pointer;transition:all .2s cubic-bezier(.4,0,.2,1);display:flex;align-items:center;justify-content:center}.btn-page[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#f1f5f9;border-color:#cbd5e1;transform:translateY(-1px)}.btn-page[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0)}.btn-page[_ngcontent-%COMP%]:disabled{color:#94a3b8;background-color:#f8fafc;border-color:#e2e8f0;cursor:not-allowed;opacity:.6}.toast-container[_ngcontent-%COMP%]{position:fixed;top:48px;right:48px;display:flex;flex-direction:column;gap:12px;z-index:2000;pointer-events:none;transition:all .3s cubic-bezier(.4,0,.2,1)}.toast[_ngcontent-%COMP%]{pointer-events:auto;padding:12px 48px;border-radius:8px;font-size:14px;font-weight:600;color:var(--color-primary);background-color:#ffffffd1;border:1px solid #cbdaee;box-shadow:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);animation:_ngcontent-%COMP%_toastAppear 5s ease-out forwards;transition:all .2s cubic-bezier(.4,0,.2,1)}@keyframes _ngcontent-%COMP%_toastAppear{0%{opacity:0;transform:translateY(-10px)}5%{opacity:1;transform:translateY(0)}95%{opacity:1;transform:translateY(0)}to{opacity:0;transform:translateY(10px)}}"]})};export{q as UserDashboardComponent};
